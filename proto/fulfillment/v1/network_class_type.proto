//
// Copyright (c) 2025 Red Hat, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with
// the License. You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on
// an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the
// specific language governing permissions and limitations under the License.
//

syntax = "proto3";

package fulfillment.v1;

import "shared/v1/metadata_type.proto";

// Describes a network implementation strategy available for creating virtual networks.
//
// NetworkClass represents a specific network backend implementation that VirtualNetworks can use. For example,
// there could be a network class `udn-net` to describe networks implemented using User-Defined Networks in
// Kubernetes, and another `phys-net` for networks backed by physical network infrastructure.
//
// This is similar to the _storage class_ concept used by Kubernetes for persistent volumes, or the _instance type_
// concept used by cloud providers for compute resources.
//
// Users query available NetworkClasses to discover which network implementation strategies they can choose when
// creating VirtualNetworks. The `implementation_strategy` field is the key identifier that VirtualNetwork resources
// reference to select their network backend.
message NetworkClass {
  // Unique identifier of the network class.
  string id = 1;

  // Metadata of the network class.
  shared.v1.Metadata metadata = 2;

  // Human friendly short description of the network class, only a few words, suitable for displaying in one single
  // line on a UI or CLI. For example: "UDN Network" or "Physical Network".
  string title = 3;

  // Human friendly long description of the network class, using Markdown format. This should explain the
  // characteristics of networks created using this class, including performance characteristics, isolation
  // guarantees, and any limitations or requirements.
  string description = 4;

  // Implementation strategy identifier for this network class. This is the discriminator that VirtualNetwork
  // resources use to select which network backend to use. For example: "udn-net", "phys-net", "ovn-kubernetes".
  //
  // This value is system-defined and immutable once the NetworkClass is created.
  string implementation_strategy = 5;

  // Class-specific configuration constraints and options. These define implementation-specific parameters that
  // networks using this class must or may configure.
  NetworkClassConstraints constraints = 6;

  // Capabilities that this network class supports. These describe what features are available when using this
  // network implementation strategy.
  NetworkClassCapabilities capabilities = 7;

  // Current operational status of the network class.
  NetworkClassStatus status = 8;
}

// Defines configuration constraints for a specific NetworkClass implementation.
//
// This message contains implementation-specific parameters that may be required or optional when creating
// VirtualNetworks using this class. Currently minimal to allow for future extension.
message NetworkClassConstraints {
  // Reserved for future implementation-specific constraint fields.
  // Examples might include: required VLAN ranges, MTU constraints, required subnet sizes, etc.
}

// Describes the capabilities supported by a NetworkClass.
//
// These fields indicate what network features are available when using this class for VirtualNetwork creation.
message NetworkClassCapabilities {
  // Whether this network class supports IPv4 addressing.
  bool supports_ipv4 = 1;

  // Whether this network class supports IPv6 addressing.
  bool supports_ipv6 = 2;

  // Whether this network class supports dual-stack (IPv4 + IPv6) configuration.
  bool supports_dual_stack = 3;
}

// Represents the current operational state of a NetworkClass.
message NetworkClassStatus {
  // Current lifecycle state of the network class.
  NetworkClassState state = 1;

  // Human-readable message providing additional details about the current state. For example, if the state is
  // FAILED, this message might explain what went wrong.
  optional string message = 2;
}

// Lifecycle states for NetworkClass resources.
enum NetworkClassState {
  // State is unknown or has not been determined yet.
  NETWORK_CLASS_STATE_UNSPECIFIED = 0;

  // The network class is being initialized and is not yet ready for use.
  NETWORK_CLASS_STATE_PENDING = 1;

  // The network class is fully operational and available for creating VirtualNetworks.
  NETWORK_CLASS_STATE_READY = 2;

  // The network class has encountered an error and cannot be used for creating VirtualNetworks.
  NETWORK_CLASS_STATE_FAILED = 3;
}
